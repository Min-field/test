webpackJsonp([3],{PaSj:function(t,e){},"e+pZ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("UhU/"),i=a.n(l),o=a("pBwn"),s={data:function(){return{getTemplateUrl:"/api/getAllTemplate",createTemplateUrl:"/api/createTemplate",updateTemplateUrl:"/api/updateTemplate",modifyTemplateImageUrl:"/api/modifyTemplateImage",data:[],imageUrl:"",title:"",text:"",Priority:"",dialogTableVisible:!1,dialogFormVisible:!1,form:{_id:"",title:"",text:"",imageUrl:"",priority:""},fileList:[],formLabelWidth:"120px",pageSize:50,cur_page:1,totalLength:0}},mounted:function(){this.getData()},computed:{total_page:function(){return this.totalLength/this.pageSize*10}},filters:{dateFormat:function(t){return i()(t).format("YYYY-MM-DD HH:mm:ss")}},methods:{err:function(t,e){this.$message.info(t),console.log(e.msg)},info:function(t){this.$message.info(t)},getData:function(){var t=this,e={pageSize:this.pageSize,cur_page:this.cur_page};this.$axios.post(this.getTemplateUrl,e).then(function(e){Object(o.a)(t,e)}).catch(function(e){t.err("获取数据失败",e),t.data=[]})},handleCurrentChange:function(t){this.cur_page=t,this.getData()},changeFile:function(){},handleAddition:function(){var t=this,e=this.$refs.templateImgSrc.files[0];if(void 0===e)alert("请选择图片");else if(e.size>2097152)alert("图片大于2M，资源过大会导致加载缓慢，请重新选择");else if(this.title){var a=new FormData;a.append("file",e),a.append("title",this.title),a.append("text",this.text),console.log(a.get("file")),console.log(a.get("title")),console.log(a.get("text")),this.$axios.post2(this.createTemplateUrl,a).then(function(e){t.info("上传成功"),console.log("成功上传",e),t.getData(),t.title="",t.text=""}).catch(function(e){t.err("添加数据失败",e),console.log("------错误原因----------"),console.log(e)})}else alert("请填写标题")},editTemplate:function(t,e){console.log("----行内数据------"),console.log(e),this.dialogFormVisible=!0,this.form=e},handleUpdation:function(){var t=this,e=this,a=this.form._id,l=this.form,i={templateId:a,title:l.title,text:l.text,priority:l.priority};console.log(i),this.$axios.post(this.updateTemplateUrl,i).then(function(a){if(console.log(void 0===t.$refs.templateNewImg.files[0]),void 0===t.$refs.templateNewImg.files[0])console.log("修改成功",a),e.info("修改成功"),e.dialogFormVisible=!1,e.getData();else{var l=new FormData;l.append("file",t.$refs.templateNewImg.files[0]),l.append("templateId",t.form._id),t.$axios.post2(t.modifyTemplateImageUrl,l).then(function(t){console.log("修改成功",t),e.dialogFormVisible=!1,e.info("修改成功"),e.getData()}).catch(function(e){t.err("修改数据失败",e),console.log("------修改失败原因----------"),console.log(e)})}}).catch(function(e){t.err("修改数据失败",e)})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),t._v("\n          模板管理\n        ")]),t._v(" "),a("el-breadcrumb-item",[t._v("模板列表")])],1)],1),t._v(" "),a("el-card",{staticClass:"box-card"},[a("p",{staticClass:"add-title"},[t._v("添加模板")]),t._v(" "),a("el-row",{staticClass:"add-item"},[a("el-col",{attrs:{span:5}},[a("span",[t._v("上传模板图片")])]),t._v(" "),a("input",{ref:"templateImgSrc",staticClass:"file",attrs:{name:"file",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:t.changeFile}})],1),t._v(" "),a("el-row",{staticClass:"add-item"},[a("el-col",{attrs:{span:5}},[a("span",[t._v("标题")])]),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-input",{staticClass:"handle-input",attrs:{placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1),t._v(" "),a("el-row",{staticClass:"add-item"},[a("el-col",{attrs:{span:5}},[a("span",[t._v("文案")])]),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-input",{staticClass:"text-input",attrs:{placeholder:"请输入描述文案"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:5}},[a("span",[t._v(" ")])]),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-button",{staticClass:"add-btn",attrs:{type:"success"},on:{click:t.handleAddition}},[t._v("添加")])],1)],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.data,border:""}},[a("el-table-column",{attrs:{prop:"_id",label:"id"}}),t._v(" "),a("el-table-column",{attrs:{label:"模板图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.imageUrl,height:"50"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"text",label:"文案"}}),t._v(" "),a("el-table-column",{attrs:{prop:"priority",label:"优先级",width:"60%"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(a){t.editTemplate(e.$index,e.row)}}},[a("i",{staticClass:"el-icon-edit"}),t._v("\n            修改\n          ")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"修改信息",width:"70%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"标题",prop:"title","label-width":t.formLabelWidth}},[a("el-input",{staticStyle:{width:"250px"},attrs:{"auto-complete":"off",span:5},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"文案",prop:"text","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off",span:5},model:{value:t.form.text,callback:function(e){t.$set(t.form,"text",e)},expression:"form.text"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新的优先级",prop:"priority","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},model:{value:t.form.priority,callback:function(e){t.$set(t.form,"priority",e)},expression:"form.priority"}},[a("el-option",{attrs:{label:"禁用",value:"-1"}}),t._v(" "),a("el-option",{attrs:{label:"优先1",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"优先2",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"优先3",value:"4"}}),t._v(" "),a("el-option",{attrs:{label:"优先4",value:"5"}}),t._v(" "),a("el-option",{attrs:{label:"优先5",value:"5"}}),t._v(" "),a("el-option",{attrs:{label:"优先6",value:"6"}}),t._v(" "),a("el-option",{attrs:{label:"优先7",value:"7"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"新的模板图片","label-width":t.formLabelWidth}},[a("input",{ref:"templateNewImg",staticClass:"file",attrs:{name:"file",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:t.changeFile}}),t._v(" "),a("p",[t._v("(若不想更改图片，可以不进行选择)")])])],1),t._v(" "),a("div",{staticClass:"dialog-footer-center"},[a("el-button",{attrs:{type:"success"},on:{click:t.handleUpdation}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")])],1)],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.cur_page,total:t.total_page},on:{"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var r=a("Z0/y")(s,n,!1,function(t){a("PaSj")},"data-v-c5c85132",null);e.default=r.exports}});
//# sourceMappingURL=3.31d811279d40ca44f75d.js.map